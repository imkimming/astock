# A股历史行情数据统计

## 简介
通过获取新浪股票行情接口的实时交易数据，统计历史交易情况。

## 目录结构

- db 历史交易数据存储目录，采用csv文件存储，日期做文件夹，每只股票一个文件
- graph 分时、日K、周K、月K图表的存储目录
- instance 基于Flask开发的网站的实例目录，存放配置文件
- stat 统计结果的存储路径，csv格式
   - code 存储每只股票的历史交易数据统计结果
   - date 存储每个交易日的交易统计结果
- web 基于Flask开发的网站
- get_all_stock_tick.py 使用多线程获取新浪股票行情接口的是实时交易数据，写入csv文件
- split_csv_files.py 分割csv文件，去重，按时间戳排序后按每只股票一个csv文件存储
- get_graph.py 获取分时、日K、周K、月K图表
- process_tick.py 处理实时行情数据，统计买卖成交量和成本
- replay_tick.py 行情回放，可查看某个历史交易日的某只股票的交易明细
- utils.py 一些工具函数
- main.py 定时任务的运行脚本，运行后会完成以上数据获取和处理工作
- stock.py 单独运行的一个查看实时行情的脚本，功能跟replay_tick.py差不多，开盘期间运行的，可获得每一笔交易数据，判断是属于主动买还是主动卖，主动买卖的成交数量和均价
- start.sh 启动Flask网站的脚本


## 用法
- 把 main.py 设置为定时任务，每个交易日的9：15开始运行
- 获得一个完整交易日的历史数据后，运行 start.sh启动网站，访问localhost:5000 可查看历史统计结果
- 交易日的开盘期间，可运行 python stock.py sh600001 查看某只股票的实时行情，把sh600001换成具体想查看的股票代码

## 依赖库
- tushare >= 1.1.7
- pandas >= 0.20.3
- flask >= 1.0.0

## 下一步计划
- 后端用Flask实现接口，前端用Vue展示数据
- 用MySQL或MongoDB存储数据。由于每天大概有1G的交易数据，阿里云服务器上的空间有限，暂时没有才用，而pandas读取csv文件也很快很方便
